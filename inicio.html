<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zona de Entrenamiento de Excelencia Operacional</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background-color: #f5f5f5; }
        .top-header { background-color: #003366; padding: 10px 0; }
        .header-container { max-width: 1400px; margin: 0 auto; padding: 0 20px; display: flex; justify-content: space-between; align-items: center; }
        .logo { display: flex; align-items: center; color: white; cursor: pointer; text-decoration: none; }
        .logo:hover { opacity: 0.9; }
        .search-box { flex: 1; max-width: 600px; margin: 0 40px; }
        .search-box input { width: 100%; padding: 10px 15px; border: none; border-radius: 4px; font-size: 14px; }
        .main-nav { background-color: white; border-bottom: 1px solid #ddd; }
        .nav-container { max-width: 1400px; margin: 0 auto; padding: 0 20px; display: flex; gap: 30px; }
        .nav-container a { color: #003366; text-decoration: none; padding: 15px 0; font-weight: 500; display: inline-block; cursor: pointer; }
        .nav-container a:hover { color: #0066cc; }
        .sub-nav { background-color: #1a2c4d; padding: 20px 0; }
        .breadcrumb { background-color: #f9f9f9; padding: 15px 0; border-bottom: 1px solid #ddd; }
        .breadcrumb-container { max-width: 1400px; margin: 0 auto; padding: 0 20px; }
        .breadcrumb a { color: #0066cc; text-decoration: none; cursor: pointer; }
        .breadcrumb a:hover { text-decoration: underline; }
        .breadcrumb span { color: #666; margin: 0 8px; }
        .content-wrapper { max-width: 1400px; margin: 30px auto; padding: 0 20px; display: flex; gap: 30px; }
        .products-container { flex: 1; }
        .products-header { background-color: #1a2c4d; color: white; padding: 15px 20px; border-radius: 4px; margin-bottom: 20px; }
        .filters-sidebar { width: 280px; flex-shrink: 0; }
        .filter-card { background: white; padding: 20px; border-radius: 4px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .filter-card h3 { color: #003366; font-size: 16px; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #0066cc; }
        .filter-group { margin-bottom: 12px; }
        .filter-checkbox { display: flex; align-items: center; gap: 8px; padding: 8px 0; cursor: pointer; }
        .filter-checkbox input[type="checkbox"] { cursor: pointer; width: 18px; height: 18px; }
        .filter-checkbox label { cursor: pointer; color: #333; font-size: 14px; flex: 1; }
        .filter-count { color: #999; font-size: 13px; }
        .clear-filters { background: none; border: none; color: #0066cc; cursor: pointer; font-size: 14px; text-decoration: underline; padding: 10px 0; }
        .clear-filters:hover { color: #0052a3; }
        .product-card { background: white; padding: 20px; border-radius: 4px; margin-bottom: 15px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); display: flex; justify-content: space-between; align-items: center; }
        .product-info h3 { color: #003366; margin-bottom: 10px; font-size: 18px; }
        .product-meta { display: flex; gap: 15px; color: #666; font-size: 14px; }
        .view-details-btn { background-color: #0066cc; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-weight: 500; white-space: nowrap; }
        .view-details-btn:hover { background-color: #0052a3; }
        .back-link { display: inline-block; color: #0066cc; text-decoration: none; margin-bottom: 20px; font-size: 14px; cursor: pointer; }
        .back-link:hover { text-decoration: underline; }
        .course-header { background: white; padding: 30px; border-radius: 4px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .course-title { color: #003366; font-size: 32px; margin-bottom: 15px; }
        .course-meta { display: flex; gap: 20px; color: #666; font-size: 14px; margin-bottom: 20px; }
        .course-meta span { display: flex; align-items: center; gap: 5px; }
        .course-tags { display: flex; gap: 10px; flex-wrap: wrap; }
        .tag { background-color: #e6f2ff; color: #003366; padding: 6px 12px; border-radius: 20px; font-size: 13px; }
        .content-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 20px; }
        .main-content { background: white; padding: 30px; border-radius: 4px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .sidebar-info { display: flex; flex-direction: column; gap: 20px; }
        .info-card { background: white; padding: 25px; border-radius: 4px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .info-card h3 { color: #003366; margin-bottom: 15px; font-size: 18px; }
        .info-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #f0f0f0; }
        .info-row:last-child { border-bottom: none; }
        .info-label { color: #666; font-weight: 500; }
        .info-value { color: #333; text-align: right; }
        .section { margin-bottom: 30px; }
        .section h2 { color: #003366; font-size: 24px; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #0066cc; }
        .section p { color: #333; line-height: 1.6; margin-bottom: 15px; }
        .section ul { color: #333; line-height: 1.8; margin-left: 20px; }
        .section li { margin-bottom: 8px; }
        .cta-button { width: 100%; background-color: #0066cc; color: white; border: none; padding: 15px; border-radius: 4px; font-size: 16px; font-weight: 500; cursor: pointer; margin-top: 15px; }
        .cta-button:hover { background-color: #0052a3; }
        .secondary-button { width: 100%; background-color: white; color: #0066cc; border: 2px solid #0066cc; padding: 15px; border-radius: 4px; font-size: 16px; font-weight: 500; cursor: pointer; margin-top: 10px; display: block; text-align: center; text-decoration: none; box-sizing: border-box; }
        .secondary-button:hover { background-color: #f0f7ff; }
        .price { font-size: 28px; color: #003366; font-weight: bold; margin: 15px 0; }
        .schedule-list { list-style: none; margin-left: 0; }
        .schedule-item { padding: 15px; background-color: #f9f9f9; margin-bottom: 10px; border-radius: 4px; border-left: 3px solid #0066cc; }
        .schedule-date { font-weight: 600; color: #003366; margin-bottom: 5px; }
        .schedule-location { color: #666; font-size: 14px; }
        .page-section { display: none; }
        .page-section.active { display: block; }
        
        /* Bot√≥n toggle para filtros en m√≥viles */
        .filter-toggle { display: none; background-color: #0066cc; color: white; border: none; padding: 12px 20px; border-radius: 4px; cursor: pointer; font-weight: 500; margin-bottom: 15px; width: 100%; }
        .filter-toggle:hover { background-color: #0052a3; }
        
        /* Media Queries para Responsive Design */
        @media (max-width: 768px) {
            .header-container { flex-direction: column; gap: 10px; padding: 15px 10px; }
            .logo span { font-size: 18px; }
            .logo svg { width: 30px; height: 30px; }
            .search-box { max-width: 100%; margin: 10px 0 0 0; }
            .search-box input { font-size: 16px; padding: 12px; }
            
            .nav-container { padding: 0 10px; }
            .breadcrumb-container { padding: 0 10px; font-size: 13px; }
            
            .content-wrapper { flex-direction: column; gap: 15px; padding: 0 10px; margin: 15px auto; }
            
            /* Filtros sidebar - oculto por defecto en m√≥vil */
            .filters-sidebar { width: 100%; display: none; }
            .filters-sidebar.active { display: block; }
            .filter-toggle { display: block; }
            .filter-card { padding: 15px; }
            
            .products-header { padding: 12px 15px; font-size: 14px; }
            
            /* Tarjetas de productos */
            .product-card { flex-direction: column; gap: 15px; padding: 15px; align-items: flex-start; }
            .product-info h3 { font-size: 16px; }
            .product-meta { flex-wrap: wrap; gap: 8px; font-size: 13px; }
            .view-details-btn { width: 100%; }
            
            /* P√°gina de detalles */
            .course-header { padding: 20px 15px; }
            .course-title { font-size: 24px; }
            .course-meta { flex-wrap: wrap; gap: 10px; font-size: 13px; }
            
            .content-grid { grid-template-columns: 1fr; gap: 15px; }
            .main-content { padding: 20px 15px; }
            .info-card { padding: 20px 15px; }
            
            .section h2 { font-size: 20px; }
            .section p, .section ul { font-size: 14px; }
            
            .info-row { flex-direction: column; gap: 5px; }
            .info-value { text-align: left; }
        }
        
        @media (max-width: 480px) {
            .logo span { font-size: 16px; }
            .course-title { font-size: 20px; }
            .section h2 { font-size: 18px; }
        }
    </style>
</head>
<body>
    <div class="top-header">
        <div class="header-container">
            <a onclick="showHome()" class="logo">
                <svg width="40" height="40" viewBox="0 0 40 40">
                    <circle cx="20" cy="20" r="18" fill="white"/>
                    <text x="20" y="26" text-anchor="middle" font-size="20" fill="#003366" font-weight="bold">ZEEO</text>
                </svg>
                <span style="font-size: 24px; font-weight: bold; margin-left: 10px;">Zona de Entrenamiento de Excelencia Operacional</span>
            </a>
            <div class="search-box">
                <input type="text" id="search-input" placeholder="Buscar cursos, entrenamientos y m√°s" oninput="searchCourses()">
            </div>
        </div>
    </div>

    <div id="page-home" class="page-section active">
        <div class="main-nav">
            <div class="nav-container">
                <a onclick="showHome()">Buscar Entrenamientos</a>
            </div>
        </div>

        <div class="content-wrapper">
            <button class="filter-toggle" onclick="toggleFilters()">üîç Mostrar Filtros</button>
            
            <aside class="filters-sidebar" id="filters-sidebar">
                <div class="filter-card">
                    <h3>Categor√≠a</h3>
                    <div class="filter-group" id="category-filters">
                        <!-- Filtros de categor√≠a se generar√°n din√°micamente -->
                    </div>
                </div>

                <div class="filter-card">
                    <h3>Otros Entrenamientos</h3>
                    <div style="padding: 10px 0; color: #333; line-height: 1.6;">
                        <p style="margin-bottom: 8px; font-size: 14px;">¬øEst√°s buscando entrenamientos virtuales?</p>
                        <p style="margin-bottom: 15px; font-size: 13px; color: #666;">Visita nuestra plataforma de capacitaci√≥n digital haciendo clic en el siguiente bot√≥n.</p>
                    </div>
                    <button class="secondary-button" style="margin-top: 10px;" onclick="window.open('https://sites.google.com/view/entrenamientosdigitales', '_blank')">Ir a Entrenamientos Virtuales</button>
                </div>

                <button class="clear-filters" onclick="clearAllFilters()">Limpiar Filtros</button>
            </aside>

            <main class="products-container" style="flex: 1;">
                <div class="products-header"><span id="results-count">0</span> cursos disponibles</div>
                <div id="courses-list">
                    <!-- Los cursos se cargar√°n aqu√≠ din√°micamente -->
                </div>
            </main>
        </div>
    </div>

    <div id="page-details" class="page-section">
        <div class="breadcrumb">
            <div class="breadcrumb-container">
                <a onclick="showHome()">Buscar Entrenamientos</a>
                <span>‚Ä∫</span>
                <a onclick="showHome()" id="breadcrumb-category">Categor√≠a</a>
                <span>‚Ä∫</span>
                <span id="breadcrumb-title">T√≠tulo del Curso</span>
            </div>
        </div>

        <div class="content-wrapper" style="display: block;">
            <a onclick="showHome()" class="back-link">‚Üê Volver a Todos los Entrenamientos</a>

            <div class="course-header">
                <h1 class="course-title" id="course-title">T√≠tulo del Curso</h1>
                <div class="course-meta" id="course-meta"></div>
                <div class="course-tags" id="course-tags"></div>
            </div>

            <div class="content-grid">
                <div class="main-content">
                    <div class="section" id="section-overview"></div>
                    <div class="section" id="section-learnings"></div>
                    <div class="section" id="section-audience"></div>
                    <div class="section" id="section-prerequisites"></div>
                    <div class="section" id="section-topics"></div>
                </div>

                <aside class="sidebar-info">
                    <div class="info-card" id="card-information"></div>
                 <!--   <div class="info-card" id="card-schedules"></div> -->
                    <div class="info-card" id="card-instructor"></div>
                </aside>
            </div>
        </div>
    </div>

    <script>
        // Variable global para almacenar los cursos
        let coursesData = {};

        // Funci√≥n para parsear CSV correctamente (maneja saltos de l√≠nea dentro de campos)
        function parseCSV(csvText) {
            const rows = [];
            let currentRow = [];
            let currentField = '';
            let insideQuotes = false;
            let i = 0;

            while (i < csvText.length) {
                const char = csvText[i];
                
                if (char === '"') {
                    if (insideQuotes && csvText[i + 1] === '"') {
                        // Comillas escapadas dentro de un campo
                        currentField += '"';
                        i += 2;
                        continue;
                    } else {
                        // Inicio o fin de un campo entrecomillado
                        insideQuotes = !insideQuotes;
                        i++;
                        continue;
                    }
                }
                
                if (char === ',' && !insideQuotes) {
                    // Fin de campo
                    currentRow.push(currentField.trim());
                    currentField = '';
                    i++;
                    continue;
                }
                
                if ((char === '\n' || char === '\r') && !insideQuotes) {
                    // Fin de fila
                    if (currentField || currentRow.length > 0) {
                        currentRow.push(currentField.trim());
                        if (currentRow.some(f => f)) {
                            rows.push(currentRow);
                        }
                        currentRow = [];
                        currentField = '';
                    }
                    if (char === '\r' && csvText[i + 1] === '\n') {
                        i += 2;
                    } else {
                        i++;
                    }
                    continue;
                }
                
                // Agregar car√°cter al campo actual
                currentField += char;
                i++;
            }
            
            // Procesar el √∫ltimo campo/fila
            if (currentField || currentRow.length > 0) {
                currentRow.push(currentField.trim());
                if (currentRow.some(f => f)) {
                    rows.push(currentRow);
                }
            }
            
            return rows;
        }

        // Funci√≥n para procesar CSV y llenar coursesData con el nuevo esquema de columnas
        function processCSVData(csvText) {
            const rows = parseCSV(csvText);
            if (rows.length < 2) throw new Error('CSV vac√≠o o sin datos');

            // Normaliza encabezados eliminando acentos, espacios y caracteres especiales
            const normalizeKey = (text = '') => text
                .normalize('NFD')
                .replace(/[\u0300-\u036f]/g, '')
                .toLowerCase()
                .replace(/[^a-z0-9]+/g, '');

            const headers = rows[0].map(h => normalizeKey(h));
            coursesData = {};

            const getValue = (values, key) => {
                const idx = headers.indexOf(key);
                if (idx === -1) return '';
                return (values[idx] || '').trim();
            };

            const splitToList = (text) => {
                if (!text) return [];
                const hasNewlines = /\r|\n/.test(text);
                const separator = hasNewlines ? /\r?\n/ : ';';
                return text
                    .split(separator)
                    .map(v => v.trim())
                    .filter(Boolean);
            };

            for (let i = 1; i < rows.length; i++) {
                const values = rows[i];
                if (!values || values.every(v => !v || !v.trim())) continue;

                const rawCategory = getValue(values, 'categoria');
                const rawCategoryCode = getValue(values, 'codigocategoria');
                const rawTitle = getValue(values, 'cursos');
                const rawCourseCode = getValue(values, 'codidocurso');
                const rawDuration = getValue(values, 'duracionhoras') || getValue(values, 'duracion');
                const rawTopics = getValue(values, 'temasdelcurso');
                const rawAudience = getValue(values, 'aquienestadirigido');
                const rawDescription = getValue(values, 'descripciondelcurso') || getValue(values, 'descripcion');
                const rawLearnings = getValue(values, 'loqueaprenderas');
                
                // Debug: imprimir datos de la primera fila
                if (i === 1) {
                    console.log('Headers:', headers);
                    console.log('Valores fila 1:', {
                        rawCategory, rawCategoryCode, rawTitle, rawCourseCode, 
                        rawDuration, rawTopics, rawAudience, rawDescription, rawLearnings
                    });
                }

                const courseId = rawCourseCode || rawTitle || `curso-${i}`;
                const durationText = rawDuration ? `${rawDuration} horas` : '';

                coursesData[courseId] = {
                    id: courseId,
                    title: rawTitle || courseId,
                    category: rawCategory || 'General',
                    program: rawCategory || rawCategoryCode || 'Programa',
                    programCode: rawCategoryCode || '',
                    format: 'Presencial',
                    duration: durationText,
                    courseCode: rawCourseCode || courseId,
                    overview: rawDescription ? [rawDescription] : ['Curso de capacitaci√≥n especializada.'],
                    learnings: splitToList(rawLearnings),
                    whoShouldAttend: splitToList(rawAudience),
                    prerequisites: 'Ninguno',
                    topics: splitToList(rawTopics),
                    instructor: {
                        name: 'Instructor Certificado',
                        bio: ''
                    },
                    tags: [rawCategoryCode, rawCategory].filter(Boolean)
                };
            }
        }

        // Funci√≥n para crear un timeout en una promise
        function withTimeout(promise, timeoutMs) {
            return Promise.race([
                promise,
                new Promise((_, reject) =>
                    setTimeout(() => reject(new Error(`Timeout despu√©s de ${timeoutMs}ms`)), timeoutMs)
                )
            ]);
        }

        // Funci√≥n para cargar desde GitHub Raw
        async function loadFromGitHub() {
            console.log('üîÑ Intentando cargar desde GitHub Raw...');
            const csvUrl = 'https://raw.githubusercontent.com/jalcala11/HSE_CVX_TRAINING/refs/heads/main/CursosEM.csv';
            
            const loadPromise = (async () => {
                const response = await fetch(csvUrl);
                if (!response.ok) throw new Error(`GitHub error: ${response.status}`);
                
                // Obtener como ArrayBuffer y decodificar expl√≠citamente como UTF-8
                const buffer = await response.arrayBuffer();
                const decoder = new TextDecoder('utf-8');
                let csvText = decoder.decode(buffer);
                
                if (!csvText || csvText.length < 10) throw new Error('Respuesta vac√≠a o inv√°lida');
                processCSVData(csvText);
            })();
            
            await withTimeout(loadPromise, 5000);
            console.log(`‚úÖ ${Object.keys(coursesData).length} cursos cargados desde GitHub`);
        }

        // Funci√≥n principal: carga desde GitHub Raw
        async function loadCourses() {
            try {
                console.log('üìç Cargando cursos desde GitHub Raw...');
                await loadFromGitHub();
                console.log('‚úÖ Cursos cargados exitosamente desde GitHub');
                renderFilters();
                renderCourses();
            } catch (error) {
                console.error('‚ùå Error al cargar cursos desde GitHub:', error);
                alert('Error al cargar los cursos. Por favor, verifica tu conexi√≥n a Internet.');
            }
        }

        // Renderizar filtros din√°micamente
        function renderFilters() {
            const categories = new Set();
            
            Object.values(coursesData).forEach(course => {
                categories.add(course.category);
            });
            
            // Renderizar filtros de categor√≠a
            const categoryFiltersContainer = document.getElementById('category-filters');
            categoryFiltersContainer.innerHTML = '';
            Array.from(categories).sort().forEach(category => {
                const filterId = 'filter-' + category.toLowerCase().replace(/\s+/g, '-');
                const filterDiv = document.createElement('div');
                filterDiv.className = 'filter-checkbox';
                filterDiv.innerHTML = `
                    <input type="checkbox" id="${filterId}" value="${category}" onchange="applyFilters()">
                    <label for="${filterId}">${category}</label>
                    <span class="filter-count" id="count-${filterId}">(0)</span>
                `;
                categoryFiltersContainer.appendChild(filterDiv);
            });
        }

        // Funci√≥n para obtener icono seg√∫n formato
        function getFormatIcon(format) {
            const formatLower = (format || '').toLowerCase();
            if (formatLower.includes('presencial')) return 'üë§';
            if (formatLower.includes('virtual')) return 'üíª';
            if (formatLower.includes('hibrido') || formatLower.includes('h√≠brido')) return 'üîÑ';
            return 'üìñ';
        }

        // Funci√≥n para obtener icono seg√∫n categor√≠a
        function getCategoryIcon(category) {
            const catLower = (category || '').toLowerCase();
            if (catLower.includes('fe1') || catLower.includes('fe2') || catLower.includes('facilidades')) return 'üè≠';
            if (catLower.includes('hse')) return '‚ö†Ô∏è';
            if (catLower.includes('ss') || catLower.includes('subsuelo')) return 'üõ¢Ô∏è';
            if (catLower.includes('vv')) return '‚úì';
            if (catLower.includes('liderazgo') || catLower.includes('lw') || catLower.includes('leadership')) return 'üëî';
            if (catLower.includes('lif') || catLower.includes('izamiento')) return 'üîß';
            if (catLower.includes('ics') || catLower.includes('incident')) return 'üö®';
            if (catLower.includes('fs') || catLower.includes('campo')) return 'üèóÔ∏è';
            if (catLower.includes('ihe') || catLower.includes('electricista')) return '‚ö°';
            if (catLower.includes('coo') || catLower.includes('operation') || catLower.includes('conducta')) return 'üìã';
            return 'üìö';
        }

        // Construir enlace mailto con borrador de correo para el curso
        function buildContactMailto(course) {
            const to = 'oetraining@chevron.com';
            const subject = `Consulta curso: ${course.title} (${course.courseCode || course.id})`;
            const bodyLines = [
                'Hola equipo HSE,',
                '',
                'Estoy interesado(a) en el siguiente curso:',
                `‚Ä¢ T√≠tulo: ${course.title}`,
                `‚Ä¢ C√≥digo: ${course.courseCode || course.id}`,
                `‚Ä¢ Categor√≠a: ${course.category}`,
                `‚Ä¢ Programa: ${course.program}`,
                `‚Ä¢ Formato: ${course.format}`,
                `‚Ä¢ Duraci√≥n: ${course.duration}`,
                '',
                '¬øPodr√≠an indicarme pr√≥ximas fechas, disponibilidad y el proceso de inscripci√≥n?',
                '',
                'Gracias.'
            ];
            const mailto = `mailto:${to}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(bodyLines.join('\n'))}`;
            return mailto;
        }

        // Renderizar cursos al cargar la p√°gina
        function renderCourses() {
            const coursesList = document.getElementById('courses-list');
            coursesList.innerHTML = '';
            
            Object.values(coursesData).forEach(course => {
                const card = document.createElement('div');
                card.className = 'product-card';
                card.dataset.category = course.category;
                card.dataset.format = course.format;
                
                const formatIcon = getFormatIcon(course.format);
                const categoryIcon = getCategoryIcon(course.category);
                
                card.innerHTML = `
                    <div class="product-info">
                        <h3>${course.title}</h3>
                        <div class="product-meta">
                            <span>${categoryIcon} ${course.category}</span>
                            <span>|</span>
                            <span>${formatIcon} ${course.format}</span>
                            <span>|</span>
                            <span>‚è± ${course.duration}</span>
                        </div>
                    </div>
                    <button class="view-details-btn" onclick="showDetails('${course.id}')">Ver Detalles</button>
                `;
                
                coursesList.appendChild(card);
            });
            
            updateFilterCounts();
            document.getElementById('results-count').textContent = Object.keys(coursesData).length;
        }

        function showHome() {
            document.getElementById('page-home').classList.add('active');
            document.getElementById('page-details').classList.remove('active');
            renderCourses();
            window.scrollTo(0, 0);
        }

        function updateFilterCounts() {
            const cards = document.querySelectorAll('#courses-list .product-card');
            const counts = {};
            
            cards.forEach(card => {
                const category = card.dataset.category;
                
                // Contar por categor√≠a
                const categoryId = 'filter-' + category.toLowerCase().replace(/\s+/g, '-');
                counts[categoryId] = (counts[categoryId] || 0) + 1;
            });
            
            // Actualizar contadores en el DOM
            Object.keys(counts).forEach(id => {
                const countElement = document.getElementById('count-' + id);
                if (countElement) {
                    countElement.textContent = `(${counts[id]})`;
                }
            });
        }

        function applyFilters() {
            const categoryCheckboxes = Array.from(document.querySelectorAll('#category-filters input[type="checkbox"]:checked'));
            const selectedCategories = categoryCheckboxes.map(cb => cb.value);
            
            const cards = document.querySelectorAll('#courses-list .product-card');
            let visibleCount = 0;
            
            cards.forEach(card => {
                const cardCategory = card.dataset.category;
                const categoryMatch = selectedCategories.length === 0 || selectedCategories.includes(cardCategory);
                
                if (categoryMatch) {
                    card.style.display = 'flex';
                    visibleCount++;
                } else {
                    card.style.display = 'none';
                }
            });
            
            document.getElementById('results-count').textContent = visibleCount;
        }

        function clearAllFilters() {
            document.querySelectorAll('#page-home input[type="checkbox"]').forEach(cb => cb.checked = false);
            applyFilters();
        }

        function toggleFilters() {
            const sidebar = document.getElementById('filters-sidebar');
            const button = document.querySelector('.filter-toggle');
            sidebar.classList.toggle('active');
            button.textContent = sidebar.classList.contains('active') ? '‚úï Ocultar Filtros' : 'üîç Mostrar Filtros';
        }

        function searchCourses() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            const cards = document.querySelectorAll('#courses-list .product-card');
            let visibleCount = 0;
            
            cards.forEach(card => {
                const title = card.querySelector('h3').textContent.toLowerCase();
                const meta = card.querySelector('.product-meta').textContent.toLowerCase();
                
                if (title.includes(searchTerm) || meta.includes(searchTerm)) {
                    card.style.display = 'flex';
                    visibleCount++;
                } else {
                    card.style.display = 'none';
                }
            });
            
            document.getElementById('results-count').textContent = visibleCount;
            
            if (searchTerm.length > 0) {
                document.querySelectorAll('#page-home input[type="checkbox"]').forEach(cb => cb.checked = false);
            }
        }

        function showDetails(courseId) {
            const course = coursesData[courseId];
            if (!course) { console.error('Curso no encontrado'); return; }

            document.getElementById('course-title').textContent = course.title;
            document.getElementById('breadcrumb-title').textContent = course.title;
            document.getElementById('breadcrumb-category').textContent = course.category;

            const formatIcon = getFormatIcon(course.format);
            const categoryIcon = getCategoryIcon(course.category);
            document.getElementById('course-meta').innerHTML = `<span>${categoryIcon} ${course.category}</span><span>|</span><span>${formatIcon} ${course.format}</span><span>|</span><span>‚è± ${course.duration}</span>`;
            document.getElementById('course-tags').innerHTML = course.tags.map(tag => `<span class="tag">${tag}</span>`).join('');

            document.getElementById('section-overview').innerHTML = `<h2>Descripci√≥n del Curso</h2>${course.overview.map(p => `<p>${p}</p>`).join('')}`;
            document.getElementById('section-learnings').innerHTML = course.learnings && course.learnings.length > 0 ? `<h2>Lo que Aprender√°s</h2><ul>${course.learnings.map(item => `<li>${item}</li>`).join('')}</ul>` : '';
            document.getElementById('section-audience').innerHTML = course.whoShouldAttend && course.whoShouldAttend.length > 0 ? `<h2>A Qui√©n Est√° Dirigido</h2><p>Este curso est√° dise√±ado para:</p><ul>${course.whoShouldAttend.map(item => `<li>${item}</li>`).join('')}</ul>` : '';
            document.getElementById('section-prerequisites').innerHTML = `<h2>Prerequisitos</h2><p>${course.prerequisites}</p>`;
            document.getElementById('section-topics').innerHTML = course.topics && course.topics.length > 0 ? `<h2>Temas del Curso</h2><ul>${course.topics.map(item => typeof item === 'string' ? `<li>${item}</li>` : `<li><strong>${item.day}:</strong> ${item.topic}</li>`).join('')}</ul>` : '';

            const contactHref = buildContactMailto(course);
            document.getElementById('card-information').innerHTML = `<h3>Informaci√≥n del Curso</h3><div class="info-row"><span class="info-label">Duraci√≥n:</span><span class="info-value">${course.duration}</span></div><div class="info-row"><span class="info-label">Formato:</span><span class="info-value">${course.format}</span></div><div class="info-row"><span class="info-label">C√≥digo:</span><span class="info-value">${course.courseCode}</span></div><div class="info-row"><span class="info-label">Programa:</span><span class="info-value">${course.program}</span></div><a class="secondary-button" href="${contactHref}">Cont√°ctanos</a>`;

          //  document.getElementById('card-schedules').innerHTML = '';

            document.getElementById('card-instructor').innerHTML = `<h3>Instructor</h3><p style="color: #333; line-height: 1.6;"><strong>${course.instructor.name}</strong><br>${course.instructor.bio}</p>`;

            document.getElementById('page-home').classList.remove('active');
            document.getElementById('page-details').classList.add('active');
            window.scrollTo(0, 0);
        }

        // Inicializar al cargar la p√°gina
        window.addEventListener('DOMContentLoaded', function() {
            loadCourses();
        });
    </script>
</body>
</html>
